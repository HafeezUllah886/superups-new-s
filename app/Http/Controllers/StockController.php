<?php
 namespace App\Http\Controllers; use App\Models\products; use App\Models\stock; use App\Models\units; use App\Models\warehouses; use Illuminate\Http\Request; class StockController extends Controller { public function index() { $products = products::all(); $warehouses = warehouses::all(); return view("\x73\164\x6f\143\153\x2e\x69\x6e\x64\145\170", compact("\160\162\157\x64\165\143\x74\163", "\167\141\x72\145\x68\157\x75\x73\x65\x73")); } public function create() { } public function store(Request $request) { } public function show($id, $warehouse, $from, $to) { $product = products::find($id); if ($warehouse == "\x61\154\x6c") { $stocks = stock::where("\160\162\157\144\x75\x63\164\x49\x44", $id)->whereBetween("\144\141\164\x65", array($from, $to))->get(); $pre_cr = stock::where("\160\x72\x6f\144\165\143\x74\x49\x44", $id)->whereDate("\144\x61\164\x65", "\x3c", $from)->sum("\143\162"); $pre_db = stock::where("\x70\x72\157\144\165\x63\164\111\x44", $id)->whereDate("\144\x61\164\x65", "\x3c", $from)->sum("\x64\x62"); $cur_cr = stock::where("\x70\x72\x6f\144\x75\x63\164\x49\104", $id)->sum("\143\x72"); $cur_db = stock::where("\160\162\157\x64\165\143\164\111\104", $id)->sum("\x64\142"); } else { $stocks = stock::where("\160\162\x6f\144\x75\143\164\111\x44", $id)->whereBetween("\144\141\x74\x65", array($from, $to))->where("\x77\x61\x72\145\x68\157\x75\x73\145\111\104", $warehouse)->get(); $pre_cr = stock::where("\x70\x72\157\144\x75\x63\x74\x49\x44", $id)->whereDate("\144\141\164\145", "\x3c", $from)->where("\x77\141\x72\145\x68\157\x75\163\145\111\104", $warehouse)->sum("\143\162"); $pre_db = stock::where("\x70\x72\157\x64\165\143\x74\x49\104", $id)->whereDate("\x64\x61\164\145", "\x3c", $from)->where("\x77\x61\162\145\150\157\x75\x73\145\x49\x44", $warehouse)->sum("\144\x62"); $cur_cr = stock::where("\160\x72\157\144\165\143\x74\x49\x44", $id)->where("\167\141\x72\145\x68\x6f\x75\x73\x65\111\x44", $warehouse)->sum("\143\162"); $cur_db = stock::where("\160\162\157\144\165\x63\x74\x49\x44", $id)->where("\x77\141\x72\145\x68\x6f\x75\x73\x65\x49\104", $warehouse)->sum("\144\142"); } $pre_balance = $pre_cr - $pre_db; $cur_balance = $cur_cr - $cur_db; return view("\163\164\x6f\143\153\56\x64\x65\164\141\x69\x6c\x73", compact("\x70\162\157\x64\x75\x63\x74", "\x70\162\x65\x5f\142\141\154\x61\156\x63\x65", "\x63\x75\x72\x5f\x62\141\x6c\x61\156\143\x65", "\x73\x74\x6f\x63\153\x73", "\146\x72\x6f\155", "\x74\x6f")); } public function edit(stock $stock) { } public function update(Request $request, stock $stock) { } public function destroy(stock $stock) { } }
