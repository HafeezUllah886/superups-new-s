<?php
 namespace App\Http\Controllers; use Illuminate\Http\Request; use Illuminate\Support\Facades\Hash; use Illuminate\Support\Facades\Session; class confirmPasswordController extends Controller { public function showConfirmPasswordForm() { return view("\141\165\x74\x68\56\x63\157\x6e\x66\151\x72\155\120\141\163\163\167\157\x72\x64"); } public function confirmPassword(Request $request) { $request->validate(array("\x70\141\x73\163\167\157\162\x64" => "\162\145\x71\x75\x69\x72\145\144")); if (Hash::check($request->password, auth()->user()->password)) { session(array("\143\x6f\156\146\151\x72\x6d\x65\144\x5f\x70\x61\x73\x73\x77\157\x72\x64" => true)); $intendedUrl = Session::get("\x69\156\x74\x65\156\x64\x65\144\x5f\165\x72\154", "\57"); Session::forget("\151\156\164\145\156\144\145\144\x5f\x75\x72\x6c"); return redirect($intendedUrl); } else { return redirect(Session::get("\160\x72\x65\x76\137\x75\x72\154", "\57"))->with("\x65\x72\162\x6f\162", "\x57\x72\157\x6e\147\x20\x50\141\163\x73\167\157\162\144"); } } }
